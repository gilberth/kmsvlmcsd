# 🖥️ vlmcsd – KMS Server

**vlmcsd** es un servidor KMS (*Key Management Service*) emulador que permite activar productos **Microsoft Windows** y **Office**.  
Emula un servidor KMS en tu red local, permitiendo que los clientes activen su software sin conectarse a los servidores de Microsoft.

---

## ✨ Características

- **Ligero** – Imagen Docker optimizada con soporte SSL.  
- **Multiplataforma** – Soporte para arquitecturas `amd64` y `arm64`.  
- **Autocontenido** – No requiere dependencias externas.  
- **Seguro** – Construido con `Dockerfile.secure` y buenas prácticas de seguridad.  
- **Persistente** – Configuración con reinicio automático.  

---

## 🚀 Despliegue Rápido con Docker

### 1️⃣ Requisitos Previos
- **Docker** instalado en el sistema.
- **Puerto 1688** abierto (puerto estándar para KMS, configurable).
- **Acceso a red local** para los clientes que requieran activación.

### 2️⃣ Comando de despliegue rápido
\`\`\`bash
docker run -d   --name vlmcsd   --restart unless-stopped   -p 1688:1688   ghcr.io/gilberth/kms:latest
\`\`\`

### 3️⃣ Verificación
\`\`\`bash
# Verificar que el contenedor está en ejecución
docker ps

# Ver logs del servidor
docker logs vlmcsd

# Probar el servidor
docker exec vlmcsd /usr/bin/vlmcs -v localhost
\`\`\`

---

## 🐳 Opciones de Despliegue

### 📦 Despliegue Básico
\`\`\`bash
docker pull ghcr.io/gilberth/kms:latest
docker run -d   --name vlmcsd   --restart unless-stopped   -p 1688:1688   ghcr.io/gilberth/kms:latest
\`\`\`

### 📄 Docker Compose
Archivo \`docker-compose.yml\`:
\`\`\`yaml
version: '3.8'
services:
  vlmcsd:
    image: ghcr.io/gilberth/kms:latest
    container_name: vlmcsd
    restart: unless-stopped
    ports:
      - "1688:1688"
    # Opcional: configuración personalizada
    # volumes:
    #   - ./vlmcsd.ini:/etc/vlmcsd.ini:ro
\`\`\`
Ejecutar:
\`\`\`bash
docker-compose up -d
\`\`\`

### ⚙️ Configuración Avanzada
\`\`\`bash
# Con archivo de configuración
docker run -d   --name vlmcsd   --restart unless-stopped   -p 1688:1688   -v /ruta/a/vlmcsd.ini:/etc/vlmcsd.ini:ro   ghcr.io/gilberth/kms:latest

# Con puerto personalizado
docker run -d   --name vlmcsd   --restart unless-stopped   -p 1689:1688   ghcr.io/gilberth/kms:latest
\`\`\`

---

## 🛠️ Activación de Clientes

### 💻 Windows
\`\`\`cmd
slmgr /skms TU_IP_SERVIDOR:1688
slmgr /ato
slmgr /xpr
\`\`\`

### 📄 Office 2019/2021
\`\`\`cmd
cscript "C:\Program Files\Microsoft Office\Office16\ospp.vbs" /sethst:TU_IP_SERVIDOR
cscript "C:\Program Files\Microsoft Office\Office16\ospp.vbs" /act
cscript "C:\Program Files\Microsoft Office\Office16\ospp.vbs" /dstatus
\`\`\`

---

## 📋 Gestión del Contenedor
\`\`\`bash
docker ps                  # Ver estado
docker stop vlmcsd         # Detener
docker start vlmcsd        # Iniciar
docker restart vlmcsd      # Reiniciar
docker logs -f vlmcsd      # Logs en tiempo real
docker rm vlmcsd           # Eliminar
\`\`\`

---

## 🔍 Pruebas y Monitoreo
\`\`\`bash
docker exec vlmcsd /usr/bin/vlmcs -v localhost
vlmcs -v TU_IP_SERVIDOR
telnet TU_IP_SERVIDOR 1688
\`\`\`

---

## 🏗️ Construcción desde Código Fuente

### Prerrequisitos
- Compilador GCC o compatible.  
- Sistema de construcción Make.  
- Librerías de desarrollo OpenSSL (opcional).

### Instrucciones
\`\`\`bash
make                   # Construcción estándar
make FEATURES=full     # Con soporte OpenSSL completo
make clean && make     # Limpiar y reconstruir
\`\`\`
Binarios generados:
- \`vlmcsd\` – Servidor KMS.  
- \`vlmcs\` – Cliente KMS para pruebas.  
- \`vlmcsdmulti\` – Binario multi-llamada.

---

## 📚 Documentación
\`\`\`bash
man man/vlmcsd.8
man man/vlmcs.1
man man/vlmcsd.7
man man/vlmcsd.ini.5
\`\`\`
Si no tienes \`man\` instalado, revisa los archivos \`.txt\`, \`.html\` y \`.pdf\` en el directorio \`man\`.

---

## ⚠️ Consideraciones de Seguridad
Consulta \`SECURITY-ANALYSIS.md\` antes de usar en producción.

---

## ⚖️ Aviso Legal
Este software es solo para **fines educativos y de prueba**.  
Asegúrate de cumplir con los términos de licencia de Microsoft y las leyes aplicables.

---

## 🤝 Contribuciones
¡Bienvenidas! Asegúrate de mantener el estilo y la documentación.
